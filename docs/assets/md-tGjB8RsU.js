import{r as h,a1 as y,f as g,o as b,i as s,g as e,t as u,F as p,aj as v,n,k as f,ad as P,b as I,w as M,e as $,v as j,x as z,S as k}from"./modules/vue-uvfpF4v6.js";import{u as w,f as B}from"./slidev/context-egudszXV.js";import{_ as N}from"./index-CB8ulYoY.js";import{I as S}from"./slidev/default-d5DqZ8N3.js";import"./modules/shiki-DxUXYpQs.js";const O={class:"border rounded-lg overflow-hidden shadow-lg bg-white dark:bg-gray-800 w-full"},T={class:"bg-gradient-to-r from-blue-500 to-purple-500 px-4 py-2 border-b flex justify-between items-center text-white"},D={class:"font-medium flex items-center space-x-2"},F={class:"flex h-[400px]"},L={class:"p-4 overflow-hidden flex-1 border-r relative"},V={class:"flex w-full h-20 mb-4 relative"},E={class:"relative h-[280px] w-full"},J={class:"absolute w-full top-[40%]"},R={class:"relative h-9 w-9 flex items-center justify-center"},H={class:"font-medium text-blue-600 dark:text-blue-300"},X={class:"absolute w-full bottom-10 left-0 text-center"},q={class:"inline-block px-5 py-2 bg-blue-50 dark:bg-blue-900/30 rounded-lg shadow-md border border-blue-100 dark:border-blue-800"},G={class:"text-sm font-medium text-blue-800 dark:text-blue-200"},K={class:"flex justify-center space-x-2 mt-4"},Q=["title","onClick"],U={class:"w-[380px] p-3 overflow-hidden flex flex-col bg-gray-50 dark:bg-gray-850"},W={class:"flex items-center justify-between mb-3 px-1"},Y={class:"text-xs font-medium px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded-full"},Z={class:"flex-1 border rounded-lg bg-white dark:bg-gray-800 overflow-auto shadow-inner"},ee={class:"flex justify-between items-center mb-1.5"},te={class:"font-medium text-sm text-blue-700 dark:text-blue-300"},le={class:"text-xs px-2 py-0.5 bg-gray-100 dark:bg-gray-700 rounded text-gray-500 dark:text-gray-400"},oe={class:"flex items-center text-xs text-blue-600 dark:text-blue-300 mb-2 bg-blue-50 dark:bg-blue-900/20 p-1.5 rounded"},re={class:"font-mono text-xs text-gray-600 dark:text-gray-300 leading-relaxed mt-1 p-2 border-l-2 border-gray-200 dark:border-gray-700"},se={key:0,class:"p-4 text-center"},ae=10,ie={__name:"MCPCallFlowExplainer",setup(C){w();const t=h(0),d=h([]),m=["用户","聊天客户端","MCP服务器","AI"],l=[{title:"1A. 客户端连接MCP",description:"聊天客户端连接到配置好的MCP服务器",from:"聊天客户端",to:"MCP服务器",message:"建立连接",log:"客户端初始化时自动连接到配置好的MCP服务器地址，建立连接。"},{title:"1B. 获取工具列表",description:"客户端向MCP服务器请求可用工具",from:"聊天客户端",to:"MCP服务器",message:"请提供可用工具",log:"客户端发送listTools请求，MCP服务器接收到请求并开始查询可用工具列表。"},{title:"2. 返回工具信息",description:"MCP服务器提供工具参数和说明",from:"MCP服务器",to:"聊天客户端",message:"工具详情和参数格式",log:"MCP服务器返回JSON格式的工具列表，包含每个工具的名称、描述、参数格式和返回值类型。"},{title:"3A. 用户提问",description:"用户向客户端提出问题",from:"用户",to:"聊天客户端",message:"查询北京天气",log:"用户在聊天界面输入问题，客户端接收到用户输入并准备处理。"},{title:"3B. 转发到AI",description:"客户端将用户问题转发给AI",from:"聊天客户端",to:"AI",message:"用户问:查询北京天气",log:"客户端将用户问题及可用工具(mcp 工具转成 function call)定义一起发送给AI模型，等待AI处理。"},{title:"4A. AI决定使用工具",description:"AI决定使用工具并告知客户端",from:"AI",to:"聊天客户端",message:"我需要使用check_weather(北京)",log:"AI分析用户问题后决定调用check_weather工具，生成标准格式的工具调用请求。"},{title:"4B. 客户端调用MCP",description:"客户端将AI的请求转为MCP调用",from:"聊天客户端",to:"MCP服务器",message:"执行:check_weather(北京)",log:"客户端将AI的function_call响应解析为MCP请求格式，然后发送给MCP服务器。"},{title:"5A. 返回工具结果",description:"MCP服务器将结果返回给客户端",from:"MCP服务器",to:"聊天客户端",message:"北京:晴,25°C",log:"MCP服务器执行工具调用(可能查询外部API或本地服务)，将结果以JSON格式返回给客户端。"},{title:"5B. 转发结果给AI",description:"客户端将工具执行结果提供给AI",from:"聊天客户端",to:"AI",message:"工具返回:北京:晴,25°C",log:"客户端将MCP返回的结果格式化后作为function_call的返回值发送给AI，以便AI生成最终回复。"},{title:"6. AI生成回复",description:"AI根据工具结果生成回复",from:"AI",to:"聊天客户端",message:"北京今天天气晴朗,温度25°C",log:"AI根据工具返回的数据生成人性化的回复，并发送给客户端。"},{title:"7. 显示给用户",description:"客户端将AI的回复显示给用户",from:"聊天客户端",to:"用户",message:"北京今天天气晴朗,温度25°C",log:"客户端接收到AI的回复，在聊天界面呈现给用户，完成一次完整的交互流程。"}],a={用户:{icon:"i-carbon-user-avatar",color:"bg-blue-50 dark:bg-blue-950",text:"text-blue-600 dark:text-blue-300",borderColor:"border-blue-300"},聊天客户端:{icon:"i-carbon-application-web",color:"bg-purple-50 dark:bg-purple-950",text:"text-purple-600 dark:text-purple-300",borderColor:"border-purple-300"},MCP服务器:{icon:"i-carbon-cloud-service-management",color:"bg-green-50 dark:bg-green-950",text:"text-green-600 dark:text-green-300",borderColor:"border-green-300"},AI:{icon:"i-carbon-machine-learning-model",color:"bg-amber-50 dark:bg-amber-950",text:"text-amber-600 dark:text-amber-300",borderColor:"border-amber-300"}};y(t,i=>{l[i]&&!d.value.some(r=>r.step===i)&&d.value.push({step:i,title:l[i].title,message:l[i].message,log:l[i].log,timestamp:new Date().toLocaleTimeString()})});function A(){t.value<ae?t.value++:(t.value=0,d.value=[])}function c(i){const r=m.indexOf(i),o=100/m.length;return r*o+o/2}function _(i,r){return m.indexOf(i)<m.indexOf(r)}return y(()=>d.value.length,i=>{i===0&&l[t.value]&&d.value.push({step:t.value,title:l[t.value].title,message:l[t.value].message,log:l[t.value].log,timestamp:new Date().toLocaleTimeString()})},{immediate:!0}),(i,r)=>(b(),g("div",O,[s(" 标题栏 "),e("div",T,[e("div",D,[r[0]||(r[0]=e("div",{class:"i-carbon-flow text-xl"},null,-1)),e("span",null,"MCP调用流程 - "+u(l[t.value].title),1)]),e("button",{class:"px-3 py-1 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-md text-sm font-medium flex items-center space-x-1 transition-all transform hover:scale-105",onClick:A},r[1]||(r[1]=[e("span",null,"下一步",-1),e("div",{class:"i-carbon-arrow-right text-sm"},null,-1)]))]),s(" 主体内容区 - 左右布局 "),e("div",F,[s(" 左侧序列图 "),e("div",L,[s(" 背景网格 "),r[3]||(r[3]=e("div",{class:"absolute inset-0 bg-gradient-to-b from-gray-50 to-white dark:from-gray-900 dark:to-gray-800 opacity-50"},null,-1)),s(" 参与者行 "),e("div",V,[(b(),g(p,null,v(m,o=>e("div",{key:o,class:"flex-1 flex flex-col items-center"},[e("div",{class:n(["h-12 w-12 rounded-full flex items-center justify-center mb-2 shadow-md border-2 transform transition-transform hover:scale-110",[a[o].color,a[o].borderColor]])},[e("div",{class:n(["text-xl",[a[o].icon,a[o].text]])},null,2)],2),e("div",{class:n(["text-xs font-medium px-2 py-1 rounded-full",a[o].color])},u(o),3)])),64))]),s(" 生命线和消息 "),e("div",E,[s(" 生命线 "),(b(),g(p,null,v(m,o=>e("div",{key:`line-${o}`,class:n(["absolute top-0 bottom-0 w-px",o===l[t.value].from||o===l[t.value].to?"bg-blue-400 dark:bg-blue-500":"bg-gray-200 dark:bg-gray-700"]),style:f(`left: calc(${c(o)}% - 0.5px)`)},null,6)),64)),s(" 当前步骤的消息 "),e("div",J,[s(" 动画流线 "),e("div",{class:"absolute h-1 bg-gradient-to-r from-blue-300 via-blue-500 to-purple-500 rounded-full shadow-sm animate-pulse",style:f(`
                left: calc(${c(l[t.value].from)}%);
                width: calc(${Math.abs(c(l[t.value].to)-c(l[t.value].from))}%);
                ${_(l[t.value].from,l[t.value].to)?"":"transform: translateX(-100%); background: linear-gradient(to left, #93c5fd, #3b82f6, #8b5cf6);"}
                top: 12px;
              `)},null,4),s(" 发送方节点(箭头起点) "),e("div",{class:"absolute transform -translate-x-1/2 -translate-y-1/2 z-20",style:f(`
                left: calc(${c(l[t.value].from)}%);
                top: 12px;
              `)},[e("div",{class:n(["h-8 w-8 rounded-full flex items-center justify-center pulse-animation border-2 shadow-lg",[a[l[t.value].from].color,a[l[t.value].from].borderColor]])},[e("div",{class:n([a[l[t.value].from].icon,a[l[t.value].from].text])},null,2)],2)],4),s(" 接收方节点(箭头终点) "),e("div",{class:"absolute transform -translate-x-1/2 -translate-y-1/2 z-20",style:f(`
                left: calc(${c(l[t.value].to)}%);
                top: 12px;
              `)},[e("div",R,[s(" 箭头背景 "),e("div",{class:n(["absolute inset-0 transform z-20 t-[5px]",_(l[t.value].from,l[t.value].to)?"-rotate-180":"rotate-0"])},r[2]||(r[2]=[e("div",{class:"w-0 h-0 border-t-[12px] border-t-transparent border-b-[12px] border-b-transparent border-r-[16px] border-blue-500 transform -translate-x-1 animate-bounce-x"},null,-1)]),2),s(" 图标容器 "),e("div",{class:n(["h-7 w-7 rounded-full flex items-center justify-center z-10 shadow-lg border-2",[a[l[t.value].to].color,a[l[t.value].to].borderColor]])},[e("div",{class:n([a[l[t.value].to].icon,a[l[t.value].to].text])},null,2)],2)])],4),s(" 消息文本 "),e("div",{class:"absolute text-sm px-4 py-2 bg-white dark:bg-gray-800 border border-blue-200 dark:border-blue-800 rounded-lg shadow-md transform transition-all hover:scale-105",style:f(`
                left: calc(${(c(l[t.value].from)+c(l[t.value].to))/2}% - 75px);
                top: -60px;
                z-index: 30;
                min-width: 150px;
                text-align: center;
              `)},[e("div",H,u(l[t.value].message),1)],4)]),s(" 步骤描述 "),e("div",X,[e("div",q,[e("div",G,u(l[t.value].description),1)])])]),s(" 步骤指示器 "),e("div",K,[(b(),g(p,null,v(l,(o,x)=>e("div",{key:x,class:n(["w-2 h-2 rounded-full cursor-pointer transition-all hover:scale-125",x===t.value?"bg-blue-500 shadow-md":"bg-gray-300 dark:bg-gray-600 hover:bg-gray-400"]),title:o.title,onClick:ue=>t.value=x},null,10,Q)),64))])]),s(" 右侧日志区域 "),e("div",U,[e("div",W,[r[4]||(r[4]=e("div",{class:"flex items-center space-x-2"},[e("div",{class:"i-carbon-list text-blue-500 dark:text-blue-400 text-lg"}),e("div",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wide"}," 通信日志记录 ")],-1)),e("div",Y,u(d.value.length)+" 条记录 ",1)]),s(" 日志列表 "),e("div",Z,[(b(!0),g(p,null,v(d.value,(o,x)=>(b(),g("div",{key:x,class:n(["p-3 border-b last:border-b-0 transition-colors",o.step===t.value?"bg-blue-50 dark:bg-blue-900/20":"hover:bg-gray-50 dark:hover:bg-gray-750"])},[e("div",ee,[e("div",te,u(o.title),1),e("div",le,u(o.timestamp),1)]),e("div",oe,[r[5]||(r[5]=e("div",{class:"i-carbon-arrow-right inline-block mr-1.5"},null,-1)),P(" "+u(o.message),1)]),e("div",re,u(o.log),1)],2))),128)),d.value.length===0?(b(),g("div",se,r[6]||(r[6]=[e("div",{class:"i-carbon-information text-blue-300 text-2xl mx-auto mb-2"},null,-1),e("div",{class:"text-sm text-gray-500"}," 暂无日志记录 ",-1)]))):s("v-if",!0)])])])]))}},ne=N(ie,[["__scopeId","data-v-305bd214"]]),de={class:"flex justify-center"},fe={__name:"slides.md__slidev_9",setup(C){const{$clicksContext:t,$frontmatter:d}=w();return t.setup(),(m,l)=>{const a=ne;return b(),I(S,j(z(k(B)(k(d),8))),{default:M(()=>[l[0]||(l[0]=e("h1",null,"MCP工作流程演示",-1)),e("div",de,[$(a)])]),_:1},16)}}};export{fe as default};
